<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FarmaFácil - Portal do Usuário</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <style>
        :root {
            --tech-purple: #2E1A47;
            --deep-purple: #1a0f2e;
            --neon-mint: #69FFC2;
            --pure-white: #FFFFFF;
            --gray-text: #a0a0b0;
            --warning-red: #ff4757;
            --alert-orange: #ff9800;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }

        body {
            height: 100vh;
            background-color: var(--deep-purple);
            display: flex; /* Layout lado a lado */
            overflow: hidden; /* Remove rolagem da página principal */
        }

        /* --- SIDEBAR (Fixa na Esquerda) --- */
        .sidebar {
            width: 260px;
            background: linear-gradient(180deg, var(--tech-purple) 0%, #150b24 100%);
            padding: 30px 20px;
            display: flex; flex-direction: column;
            border-right: 1px solid rgba(255,255,255,0.05);
            flex-shrink: 0;
            z-index: 10;
        }

        .brand {
            display: flex; align-items: center; gap: 10px;
            font-size: 1.5rem; font-weight: 800; color: var(--pure-white);
            margin-bottom: 50px; padding-left: 10px;
        }
        .brand .material-icons { color: var(--neon-mint); font-size: 2rem; }

        .nav-menu { list-style: none; flex-grow: 1; }
        .nav-item { margin-bottom: 10px; }
        
        /* Links do Menu */
        .nav-link {
            display: flex; align-items: center; gap: 15px;
            padding: 12px 15px;
            color: var(--gray-text);
            text-decoration: none;
            border-radius: 12px;
            font-weight: 500;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }
        .nav-link:hover, .nav-link.active {
            background-color: rgba(105, 255, 194, 0.1);
            color: var(--neon-mint);
        }
        .nav-link .material-icons { font-size: 1.4rem; }

        /* Alerta na Sidebar (Bolinha Vermelha) */
        .nav-warning-badge {
            width: 10px; height: 10px;
            background-color: var(--warning-red);
            border-radius: 50%;
            margin-left: auto;
            box-shadow: 0 0 8px var(--warning-red);
            display: none; 
            animation: pulseRed 1.5s infinite;
        }
        @keyframes pulseRed { 0%, 100% {opacity: 1;} 50% {opacity: 0.5;} }

        /* Perfil Mini */
        .user-profile-mini {
            display: flex; align-items: center; gap: 10px;
            padding: 15px; background-color: rgba(0,0,0,0.2);
            border-radius: 12px; margin-top: auto;
        }
        .avatar-circle {
            width: 40px; height: 40px; background-color: var(--neon-mint);
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            color: var(--tech-purple); font-weight: 800;
        }
        .user-info div:first-child { font-weight: 700; font-size: 0.9rem; color: white;}
        .user-info div:last-child { font-size: 0.75rem; color: var(--gray-text); }
        
        .btn-logout {
            background: none; border: none; color: var(--warning-red); cursor: pointer; margin-left: auto;
        }

        /* --- ÁREA DE CONTEÚDO (IFRAME) --- */
        .content-wrapper {
            flex-grow: 1;
            background-color: var(--deep-purple);
            position: relative;
        }

        /* O Iframe ocupa 100% do espaço restante */
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        /* --- MODAL GLOBAL (KYC) --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.85); backdrop-filter: blur(4px);
            z-index: 1000; display: none; justify-content: center; align-items: center;
            animation: fadeIn 0.3s;
        }
        .modal-content {
            background-color: #2a1b3d; border: 1px solid var(--alert-orange);
            border-radius: 20px; padding: 30px; width: 90%; max-width: 450px;
            text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.6);
        }
        .modal-icon { font-size: 4rem; color: var(--alert-orange); margin-bottom: 15px; }
        .modal-title { font-size: 1.5rem; font-weight: 800; color: white; margin-bottom: 10px; }
        .modal-text { font-size: 1rem; color: rgba(255,255,255,0.8); margin-bottom: 25px; line-height: 1.5; }
        
        .modal-actions { display: flex; gap: 15px; justify-content: center; }
        .modal-btn { padding: 12px 30px; border-radius: 10px; border: none; font-weight: 700; cursor: pointer; font-size: 0.95rem; }
        .btn-modal-later { background-color: rgba(255,255,255,0.1); color: white; }
        .btn-modal-verify { background-color: var(--alert-orange); color: white; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="brand">
            <span class="material-icons">local_pharmacy</span> FarmaFácil
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a onclick="loadPage('tela_visao_geral.html', this)" class="nav-link active">
                    <span class="material-icons">dashboard</span> Visão Geral
                </a>
            </li>
            <li class="nav-item">
                <a onclick="loadPage('tela_pedidos.html', this)" class="nav-link">
                    <span class="material-icons">receipt_long</span> Meus Pedidos
                </a>
            </li>
            <li class="nav-item">
                <a onclick="loadPage('tela_favoritos.html', this)" class="nav-link">
                    <span class="material-icons">favorite</span> Favoritos
                </a>
            </li>
            <li class="nav-item">
                <a onclick="loadPage('tela_minha_conta.html', this)" class="nav-link">
                    <span class="material-icons">person</span> Minha Conta
                    <div id="sidebarAlertBadge" class="nav-warning-badge"></div>
                </a>
            </li>
        </ul>

        <div class="user-profile-mini">
            <div class="avatar-circle">GA</div>
            <div class="user-info">
                <div>Gabriel A.</div>
                <div>CPF: ***.***.789-00</div>
            </div>
            <button class="btn-logout" onclick="window.location.href='site_login.html'" title="Sair">
                <span class="material-icons">logout</span>
            </button>
        </div>
    </aside>

    <div class="content-wrapper">
        <iframe id="contentFrame" src="tela_visao_geral.html"></iframe>
    </div>

    <div id="kycModal" class="modal-overlay">
        <div class="modal-content">
            <span class="material-icons modal-icon">gpp_maybe</span>
            <div class="modal-title">Confirme sua Identidade</div>
            <div class="modal-text">
                Detectamos que sua conta ainda não possui um documento verificado. Isso é necessário para garantir sua segurança.
            </div>
            <div class="modal-actions">
                <button class="modal-btn btn-modal-later" onclick="closeModal('kycModal')">Fazer Depois</button>
                <button class="modal-btn btn-modal-verify" onclick="goToAccount()">Verificar Agora</button>
            </div>
        </div>
    </div>

    <script>
        // Função para trocar o arquivo dentro do Iframe
        function loadPage(url, element) {
            // 1. Muda o arquivo
            document.getElementById('contentFrame').src = url;

            // 2. Atualiza o menu ativo
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
            if (element) element.classList.add('active');
        }

        // Lógica Global (Roda ao carregar o site)
        document.addEventListener('DOMContentLoaded', function() {
            // Verifica se o usuário já mandou documento (Simulado)
            const isVerified = sessionStorage.getItem('userVerified') === 'true';
            const sidebarBadge = document.getElementById('sidebarAlertBadge');
            
            if (!isVerified) {
                // Mostra o modal laranja
                setTimeout(() => {
                    document.getElementById('kycModal').style.display = 'flex';
                }, 500);
                // Acende a bolinha vermelha no menu
                sidebarBadge.style.display = 'block';
            } else {
                sidebarBadge.style.display = 'none';
            }
            
            // Escuta se a tela filha (minha conta) alterou o status
            window.addEventListener('storage', () => {
                 if(sessionStorage.getItem('userVerified') === 'true') {
                     sidebarBadge.style.display = 'none';
                 } else {
                     sidebarBadge.style.display = 'block';
                 }
            });
        });

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        function goToAccount() {
            closeModal('kycModal');
            // Simula clique no 4º item do menu (Minha Conta) e carrega a tela
            const contaLink = document.querySelectorAll('.nav-link')[3]; 
            loadPage('tela_minha_conta.html', contaLink);
        }
    </script>

</body>
</html>